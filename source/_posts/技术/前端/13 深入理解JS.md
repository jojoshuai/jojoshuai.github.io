---
title: 13 深入理解JS
date: 2024-08-01 16:40:41
categories:
  - 前端
tags:
  - 前端
  - js
---

> from https://bytetech.info/videos/set/7193722320643424311/7194327690676011065

# 1. JS 的基本概念

### 1.1 打开浏览器的会启动的进程

- Brower 进程
- GPU 进程
- 渲染进程
  - GUI 线程
  - JS 线程
  - 时间触发线程
  - 定时器线程
  - 网络线程
- 插件进程、网络进程

### 1.2 JS 的线程特点

- 单线程：
  - GUI 线程和 JS 线程是互斥的
- 动态、弱类型
- 面向对象、函数式
- 解释类语言、JIT
  - js 真的是一个解释类语言吗
- 安全、性能差
  - 需要浏览器才能执行，所以相对安全

### 1.3 数据类型

- 对象
- 基础数据列星

### 1.4 变量提升

- 对于 const let 变量，需要在定义语句后使用
- 对于 var 变量，可以在定义语句前使用，但其值为 undefined
  - 因为对于 var 变量，js 会提升，在代码行开始时，自动定义 var xxx = undifuned
- 对于 func 的定义，可以在定义语句前使用
  - func 的定义会被全局提升

> 所以，可以看出，js 并非纯解释型语言，也有编译的过程

# 2. JS 是怎么执行的

### 2.1 执行流程图

![/js执行流程图](/images/js执行流程图.png)

### 2.2 执行上下文

![js执行上下文](/images/js执行上下文.png) - 全局执行上下文 - 代码开始时就会创建、将压到执行栈的栈底，每个生命周期内只有一份 - 函数执行上下文 - 当执行一个函数时，这个函数内的代码会被编译，生成变量环 境、词法环境等，当函数执行结束的时候改执行环境从栈顶弹出

> 此处涉及调用栈，每个(函数)执行上下文被执行的时候，会将此上下文压入栈顶，然后如果有新函数，则创建新执行上下文并再此压入栈顶。
> <br>故其函数深度依赖于调用栈的深度

### 2.3 创建执行上下文的时候做了什么: 绑定 This，创建词法环境，创建变量环境

    - 词法环境：
        - 基于ECMAScript代码的词法嵌套结构来定义标识符和具体变量和函数的关联。
        - 一个词法环境由环境记录器和一个可能的引用外部词法环境的空值组成
    - 变量环境：
        - 词法环境和变量环境的一个不同是：词法环境被用来存储函数声明和变量(let const)绑定；变量环境用来存储var变量绑定
    - Outer
        - 指向外部变量环境的一个指针

- 通过 ESP 来记录当前执行状态的指针(确定执行调用栈内的那个上下文)

### 2.4 闭包

![闭包的问题](/images/闭包的问题.png)

- 闭包的内存不容易被回收，所以会有一个内存泄漏的问题

### 2.5 this

![js-this](/images/this.png)

- 如果在 vscode 中，打印的是 global，因为 vscode 中是 node 环境
- 如果在浏览器中，则是 window

### 2.6 垃圾回收

# 3. JS 的进阶知识点

### 3.1 事件循环

func -> 微任务 -> 宏任务
